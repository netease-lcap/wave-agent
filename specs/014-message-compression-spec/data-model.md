# Message Compression Data Model

## Message Blocks

### Compress Block
Used in assistant messages to store the summary of compressed history.
```typescript
{
  type: "compress";
  content: string; // The summary text generated by the AI
}
```

## Input Manager State

### Long Text Map
Used in `InputManager` to track compressed user inputs.
```typescript
private longTextCounter: number;
private longTextMap: Map<string, string>; // Map<"[LongText#ID]", "Original Text">
```

## API Format

### Compressed Summary System Message
When sending messages to the AI API, compressed blocks are converted to:
```typescript
{
  role: "system",
  content: "[Compressed Message Summary] " + compressBlock.content
}
```
This message is placed at the beginning of the message list (after the main system prompt).
